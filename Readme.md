# Walmart Store Sales Forecasting - рЃЊрЃарЃЮрЃўрЃЌрЃў рЃЏрЃгрЃЎрЃарЃўрЃЋрЃћрЃЉрЃўрЃА рЃърЃарЃЮрЃњрЃюрЃЮрЃќрЃўрЃарЃћрЃЉрЃљ

## рЃърЃарЃЮрЃћрЃЦрЃбрЃўрЃА рЃљрЃдрЃгрЃћрЃарЃљ

рЃћрЃА рЃърЃарЃЮрЃћрЃЦрЃбрЃў рЃћрЃ«рЃћрЃЉрЃљ **Walmart Recruiting - Store Sales Forecasting** Kaggle рЃЎрЃЮрЃюрЃЎрЃБрЃарЃАрЃА, рЃАрЃљрЃЊрЃљрЃф рЃЏрЃўрЃќрЃљрЃюрЃўрЃљ Walmart-рЃўрЃА 45 рЃЏрЃљрЃдрЃљрЃќрЃўрЃўрЃА рЃЎрЃЋрЃўрЃарЃћрЃБрЃџрЃў рЃњрЃљрЃДрЃўрЃЊрЃЋрЃћрЃЉрЃўрЃА рЃърЃарЃЮрЃњрЃюрЃЮрЃќрЃўрЃарЃћрЃЉрЃљ рЃЊрЃћрЃърЃљрЃарЃбрЃљрЃЏрЃћрЃюрЃбрЃўрЃА рЃЏрЃўрЃ«рЃћрЃЊрЃЋрЃўрЃЌ. рЃћрЃА рЃљрЃарЃўрЃА рЃЎрЃџрЃљрЃАрЃўрЃЎрЃБрЃарЃў Time Series рЃљрЃЏрЃЮрЃфрЃљрЃюрЃљ, рЃарЃЮрЃЏрЃћрЃџрЃўрЃф рЃЏрЃЮрЃўрЃЌрЃ«рЃЮрЃЋрЃА рЃАрЃ«рЃЋрЃљрЃЊрЃљрЃАрЃ«рЃЋрЃљ рЃљрЃарЃЦрЃўрЃбрЃћрЃЦрЃбрЃБрЃарЃўрЃА рЃЏрЃЮрЃЊрЃћрЃџрЃћрЃЉрЃўрЃА рЃерЃћрЃАрЃгрЃљрЃЋрЃџрЃљрЃА рЃЊрЃљ рЃерЃћрЃЊрЃљрЃарЃћрЃЉрЃљрЃА.

### рЃЏрЃЮрЃюрЃљрЃфрЃћрЃЏрЃЌрЃљ рЃљрЃдрЃгрЃћрЃарЃљ
- **рЃЏрЃўрЃќрЃљрЃюрЃў**: Walmart-рЃўрЃА рЃЏрЃљрЃдрЃљрЃќрЃўрЃћрЃЉрЃўрЃА рЃЎрЃЋрЃўрЃарЃћрЃБрЃџрЃў рЃњрЃљрЃДрЃўрЃЊрЃЋрЃћрЃЉрЃўрЃА рЃърЃарЃЮрЃњрЃюрЃЮрЃќрЃўрЃарЃћрЃЉрЃљ рЃЊрЃћрЃърЃљрЃарЃбрЃљрЃЏрЃћрЃюрЃбрЃўрЃА рЃЏрЃўрЃ«рЃћрЃЊрЃЋрЃўрЃЌ
- **metrics**: Weighted Mean Absolute Error (WMAE)
- **рЃЏрЃљрЃдрЃљрЃќрЃўрЃћрЃЉрЃў**: 45 Walmart рЃЏрЃљрЃдрЃљрЃќрЃўрЃљ рЃАрЃ«рЃЋрЃљрЃЊрЃљрЃАрЃ«рЃЋрЃљ рЃќрЃЮрЃЏрЃўрЃАрЃљ рЃЊрЃљ рЃбрЃўрЃърЃўрЃА
- **рЃЊрЃћрЃърЃљрЃарЃбрЃљрЃЏрЃћрЃюрЃбрЃћрЃЉрЃў**: рЃњрЃљрЃюрЃАрЃ«рЃЋрЃљрЃЋрЃћрЃЉрЃБрЃџрЃў рЃЊрЃћрЃърЃљрЃарЃбрЃљрЃЏрЃћрЃюрЃбрЃћрЃЉрЃў рЃЌрЃўрЃЌрЃЮрЃћрЃБрЃџ рЃЏрЃљрЃдрЃљрЃќрЃўрЃљрЃерЃў
- **рЃњрЃљрЃарЃћ рЃцрЃљрЃЦрЃбрЃЮрЃарЃћрЃЉрЃў**: рЃбрЃћрЃЏрЃърЃћрЃарЃљрЃбрЃБрЃарЃљ, рЃАрЃљрЃгрЃЋрЃљрЃЋрЃўрЃА рЃцрЃљрЃАрЃў, рЃЏрЃљрЃарЃЎрЃЊрЃљрЃБрЃюрЃћрЃЉрЃў, рЃЊрЃдрЃћрЃАрЃљрЃАрЃгрЃљрЃБрЃџрЃћрЃЉрЃў, CPI, рЃБрЃЏрЃБрЃерЃћрЃЋрЃарЃЮрЃЉрЃўрЃА рЃЏрЃљрЃЕрЃЋрЃћрЃюрЃћрЃЉрЃћрЃџрЃў рЃЊрЃљ рЃљ.рЃе.

### рЃњрЃБрЃюрЃЊрЃў
- **рЃЎрЃћрЃАрЃЮ рЃЕрЃўрЃ«рЃџрЃљрЃФрЃћ**
- **рЃАрЃљрЃџрЃЮрЃЏрЃћ рЃДрЃљрЃарЃљрЃБрЃџрЃљрЃерЃЋрЃўрЃџрЃў**

### рЃърЃарЃЮрЃћрЃЦрЃбрЃўрЃА рЃАрЃбрЃарЃБрЃЦрЃбрЃБрЃарЃљ
```
ML_Final_Project/
РћюРћђРћђ notebooks/
Рћѓ   РћюРћђРћђ model_experiment_ARIMA.ipynb
Рћѓ   РћюРћђРћђ model_experiment_SARIMAX.ipynb  
Рћѓ   РћюРћђРћђ model_experiment_Prophet.ipynb
Рћѓ   РћюРћђРћђ model_experiment_XGBoost.ipynb
Рћѓ   РћюРћђРћђ model_experiment_LightGBM.ipynb
Рћѓ   РћюРћђРћђ model_experiment_NBEATS.ipynb
Рћѓ   РћюРћђРћђ model_experiment_TFT.ipynb
Рћѓ   РћюРћђРћђ model_experiment_PatchTST.ipynb
Рћѓ   РћюРћђРћђ model_experiment_DLinear.ipynb
Рћѓ   РћћРћђРћђ model_inference.ipynb
РћюРћђРћђ data/
Рћѓ   РћюРћђРћђ train.csv
Рћѓ   РћюРћђРћђ test.csv
Рћѓ   РћюРћђРћђ stores.csv
Рћѓ   РћюРћђРћђ features.csv
Рћѓ   РћћРћђРћђ samlpleSubmission.csv
РћюРћђРћђ scripts/
Рћѓ   РћюРћђРћђ data_processor.py
Рћѓ   РћћРћђРћђ time_series_utils.py
РћюРћђРћђ submissions/
Рћѓ   РћюРћђРћђ lightgbm_submission.csv
Рћѓ   РћюРћђРћђ arima_submission.csv
Рћѓ   РћюРћђРћђ xgboost_submission.csv
Рћѓ   РћюРћђРћђ dlinear_submission.csv
Рћѓ   РћюРћђРћђ prophet_submission.csv
Рћѓ   РћюРћђРћђ tft_submission.csv
Рћѓ   РћюРћђРћђ sarima_submission.csv
Рћѓ   РћћРћђРћђ nbeats_submission.csv
РћћРћђРћђ README.md
```

---

## рЃЏрЃЮрЃюрЃљрЃфрЃћрЃЏрЃЌрЃљ рЃљрЃюрЃљрЃџрЃўрЃќрЃў рЃЊрЃљ рЃърЃарЃћрЃърЃарЃЮрЃфрЃћрЃАрЃўрЃюрЃњрЃў

### Data Exploration and Preprocessing

##### рЃЊрЃдрЃћрЃАрЃљрЃАрЃгрЃљрЃБрЃџрЃћрЃЉрЃўрЃА рЃњрЃљрЃЋрЃџрЃћрЃюрЃљ рЃњрЃљрЃДрЃўрЃЊрЃЋрЃћрЃЉрЃќрЃћ
<img src="holiday_analysis.png" width="800" alt="Holiday Analysis"/>

рЃЏрЃљрЃЊрЃџрЃўрЃћрЃарЃћрЃЉрЃўрЃА рЃЊрЃдрЃўрЃАрЃљ рЃЊрЃљ рЃерЃЮрЃЉрЃўрЃА рЃЊрЃарЃЮрЃА рЃњрЃљрЃДрЃўрЃЊрЃЋрЃћрЃЉрЃў рЃДрЃЋрЃћрЃџрЃљрЃќрЃћ рЃЏрЃћрЃбрЃљрЃЊ рЃўрЃќрЃарЃЊрЃћрЃЉрЃљ.

##### рЃАрЃћрЃќрЃЮрЃюрЃБрЃарЃў рЃбрЃћрЃюрЃЊрЃћрЃюрЃфрЃўрЃћрЃЉрЃў
<img src="seasonal_trends.png" width="800" alt="Seasonal Trends"/>

рЃЎрЃЋрЃўрЃарЃћрЃБрЃџрЃў рЃЊрЃљ рЃЌрЃЋрЃўрЃБрЃарЃў рЃАрЃћрЃќрЃЮрЃюрЃБрЃарЃЮрЃЉрЃўрЃА рЃърЃљрЃбрЃћрЃарЃюрЃћрЃЉрЃў рЃЏрЃЎрЃљрЃцрЃўрЃЮрЃЊ рЃЕрЃљрЃюрЃА.

##### рЃЏрЃЮрЃюрЃљрЃфрЃћрЃЏрЃћрЃЉрЃўрЃА рЃАрЃўрЃАрЃљрЃЋрЃАрЃћ
<img src="missing_data_heatmap.png" width="700" alt="Missing Data Heatmap"/>

CPI рЃЊрЃљ Unemployment рЃфрЃЋрЃџрЃљрЃЊрЃћрЃЉрЃерЃў рЃДрЃЋрЃћрЃџрЃљрЃќрЃћ рЃЏрЃћрЃбрЃў missing values-рЃўрЃљ.

##### рЃћрЃЎрЃЮрЃюрЃЮрЃЏрЃўрЃЎрЃБрЃарЃў рЃўрЃюрЃЊрЃўрЃЎрЃљрЃбрЃЮрЃарЃћрЃЉрЃў
<img src="economic_trends.png" width="800" alt="Economic Trends"/>

CPI, рЃБрЃЏрЃБрЃерЃћрЃЋрЃарЃЮрЃЉрЃљ, рЃАрЃљрЃгрЃЋрЃљрЃЋрЃўрЃА рЃцрЃљрЃАрЃў рЃЊрЃљ рЃбрЃћрЃЏрЃърЃћрЃарЃљрЃбрЃБрЃарЃўрЃА рЃфрЃЋрЃџрЃўрЃџрЃћрЃЉрЃљ рЃЊрЃарЃЮрЃерЃў.

##### рЃфрЃЋрЃџрЃљрЃЊрЃћрЃЉрЃўрЃА рЃЎрЃЮрЃарЃћрЃџрЃљрЃфрЃўрЃљ
<img src="correlation_matrix.png" width="700" alt="Correlation Matrix"/>

рЃфрЃЋрЃџрЃљрЃЊрЃћрЃЉрЃўрЃА рЃБрЃарЃЌрЃўрЃћрЃарЃЌрЃЊрЃљрЃЏрЃЮрЃЎрЃўрЃЊрЃћрЃЉрЃБрЃџрЃћрЃЉрЃљ рЃЊрЃљ рЃЏрЃюрЃўрЃерЃЋрЃюрЃћрЃџрЃЮрЃЋрЃљрЃюрЃў рЃЎрЃЮрЃарЃћрЃџрЃљрЃфрЃўрЃћрЃЉрЃў.

---

## рЃЏрЃЮрЃЊрЃћрЃџрЃћрЃЉрЃўрЃА рЃљрЃарЃЦрЃўрЃбрЃћрЃЦрЃбрЃБрЃарЃћрЃЉрЃў рЃЊрЃљ рЃерЃћрЃЊрЃћрЃњрЃћрЃЉрЃў

### ­Ъј» **рЃЎрЃџрЃљрЃАрЃўрЃЎрЃБрЃарЃў рЃАрЃбрЃљрЃбрЃўрЃАрЃбрЃўрЃЎрЃБрЃарЃў Time Series рЃЏрЃЮрЃЊрЃћрЃџрЃћрЃЉрЃў**

#### ARIMA (AutoRegressive Integrated Moving Average)
**рЃЎрЃЮрЃюрЃфрЃћрЃцрЃфрЃўрЃљ**: ARIMA рЃгрЃљрЃарЃЏрЃЮрЃљрЃЊрЃњрЃћрЃюрЃА рЃЎрЃџрЃљрЃАрЃўрЃЎрЃБрЃа рЃАрЃбрЃљрЃбрЃўрЃАрЃбрЃўрЃЎрЃБрЃа рЃЏрЃЮрЃЊрЃћрЃџрЃА рЃЊрЃарЃЮрЃўрЃЌрЃў рЃЏрЃгрЃЎрЃарЃўрЃЋрЃћрЃЉрЃўрЃА рЃљрЃюрЃљрЃџрЃўрЃќрЃўрЃАрЃЌрЃЋрЃўрЃА. рЃўрЃњрЃў 3 рЃърЃљрЃарЃљрЃЏрЃћрЃбрЃарЃўрЃАрЃњрЃљрЃю рЃерЃћрЃЊрЃњрЃћрЃЉрЃљ:

**рЃЎрЃћрЃарЃФрЃЮрЃц**:
- **AR(p) - AutoRegressive**: рЃњрЃљрЃюрЃАрЃљрЃќрЃдрЃЋрЃарЃљрЃЋрЃА рЃарЃљрЃЏрЃЊрЃћрЃюрЃў рЃгрЃўрЃюрЃљ рЃЊрЃарЃЮрЃўрЃЌрЃў рЃгрЃћрЃарЃбрЃўрЃџрЃўрЃА рЃЏрЃюрЃўрЃерЃЋрЃюрЃћрЃџрЃЮрЃЉрЃљ рЃњрЃљрЃЏрЃЮрЃўрЃДрЃћрЃюрЃћрЃЉрЃљ рЃЏрЃўрЃЏрЃЊрЃўрЃюрЃљрЃарЃћ рЃЏрЃюрЃўрЃерЃЋрЃюрЃћрЃџрЃЮрЃЉрЃўрЃА рЃърЃарЃЮрЃњрЃюрЃЮрЃќрЃўрЃарЃћрЃЉрЃўрЃАрЃЌрЃЋрЃўрЃА. рЃЏрЃљрЃњрЃљрЃџрЃўрЃЌрЃљрЃЊ, рЃЌрЃБ p=2, рЃЏрЃЮрЃЊрЃћрЃџрЃў рЃўрЃДрЃћрЃюрЃћрЃЉрЃА рЃгрЃўрЃюрЃљ 2 рЃЎрЃЋрЃўрЃарЃўрЃА рЃњрЃљрЃДрЃўрЃЊрЃЋрЃћрЃЉрЃўрЃА рЃЏрЃЮрЃюрЃљрЃфрЃћрЃЏрЃћрЃЉрЃА.
- **I(d) - Integrated**: рЃњрЃљрЃюрЃАрЃљрЃќрЃдрЃЋрЃарЃљрЃЋрЃА differencing-рЃўрЃА рЃ«рЃљрЃарЃўрЃАрЃ«рЃА рЃАрЃбрЃљрЃфрЃўрЃЮрЃюрЃљрЃарЃЮрЃЉрЃўрЃА рЃЏрЃўрЃАрЃљрЃдрЃгрЃћрЃЋрЃљрЃЊ. d=1 рЃюрЃўрЃерЃюрЃљрЃЋрЃА рЃћрЃарЃЌрЃ«рЃћрЃџ рЃњрЃљрЃгрЃљрЃарЃЏрЃЮрЃћрЃЉрЃљрЃА рЃљрЃюрЃБ рЃгрЃарЃцрЃўрЃЋрЃў рЃбрЃарЃћрЃюрЃЊрЃћрЃЉрЃўрЃА рЃЏрЃЮрЃерЃЮрЃарЃћрЃЉрЃљрЃА.
- **MA(q) - Moving Average**: рЃљрЃдрЃгрЃћрЃарЃА рЃгрЃўрЃюрЃљ q рЃерЃћрЃфрЃЊрЃЮрЃЏрЃўрЃА (prediction error) рЃњрЃљрЃЋрЃџрЃћрЃюрЃљрЃА рЃЏрЃўрЃЏрЃЊрЃўрЃюрЃљрЃарЃћ рЃърЃарЃЮрЃњрЃюрЃЮрЃќрЃќрЃћ.

**рЃўрЃЏрЃърЃџрЃћрЃЏрЃћрЃюрЃбрЃљрЃфрЃўрЃўрЃА рЃЌрЃљрЃЋрЃўрЃАрЃћрЃЉрЃБрЃарЃћрЃЉрЃћрЃЉрЃў**:
- ARIMA-рЃА рЃљрЃа рЃерЃћрЃБрЃФрЃџрЃўрЃљ рЃњрЃљрЃарЃћ рЃфрЃЋрЃџрЃљрЃЊрЃћрЃЉрЃўрЃА (external features) рЃњрЃљрЃЏрЃЮрЃДрЃћрЃюрЃћрЃЉрЃљ
- рЃЏрЃ«рЃЮрЃџрЃЮрЃЊ target рЃфрЃЋрЃџрЃљрЃЊрЃќрЃћ рЃбрЃарЃћрЃюрЃўрЃюрЃњрЃЊрЃћрЃЉрЃљ
- рЃарЃљрЃЊрЃњрЃљрЃю ~3300 store-department рЃЎрЃЮрЃЏрЃЉрЃўрЃюрЃљрЃфрЃўрЃљ рЃАрЃљрЃГрЃўрЃарЃЮрЃћрЃЉрЃА рЃЉрЃћрЃЋрЃа рЃЏрЃћрЃ«рЃАрЃўрЃћрЃарЃћрЃЉрЃљрЃА, рЃњрЃљрЃЏрЃЮрЃЋрЃўрЃДрЃћрЃюрЃћрЃЌ store-level aggregation (рЃДрЃЋрЃћрЃџрЃљ рЃЏрЃљрЃдрЃљрЃќрЃўрЃўрЃАрЃЌрЃЋрЃўрЃА рЃерЃћрЃЋрЃЎрЃарЃўрЃЉрЃћрЃЌ рЃњрЃљрЃДрЃўрЃЊрЃЋрЃћрЃЉрЃў)

**рЃ░рЃўрЃърЃћрЃарЃърЃљрЃарЃљрЃЏрЃћрЃбрЃарЃћрЃЉрЃўрЃА Grid Search**:
рЃњрЃљрЃбрЃћрЃАрЃбрЃўрЃџрЃў рЃЎрЃЮрЃЏрЃЉрЃўрЃюрЃљрЃфрЃўрЃћрЃЉрЃў: (1,1,0), (0,1,1), (1,1,1), (2,1,1), (1,1,2), (2,1,2), (0,1,2), (3,1,1), (1,1,3), (4,1,1)

**рЃАрЃљрЃБрЃЎрЃћрЃЌрЃћрЃАрЃЮ рЃърЃљрЃарЃљрЃЏрЃћрЃбрЃарЃћрЃЉрЃў**: (p=2, d=1, q=3)
**Kaggle Score**: **3518.758 WMAE**


#### SARIMAX (Seasonal ARIMA with eXogenous variables)
**рЃЎрЃЮрЃюрЃфрЃћрЃцрЃфрЃўрЃљ**: SARIMAX рЃљрЃцрЃљрЃарЃЌрЃЮрЃћрЃЉрЃА ARIMA рЃЏрЃЮрЃЊрЃћрЃџрЃА рЃЮрЃарЃў рЃЏрЃюрЃўрЃерЃЋрЃюрЃћрЃџрЃЮрЃЋрЃљрЃюрЃў рЃЎрЃЮрЃЏрЃърЃЮрЃюрЃћрЃюрЃбрЃўрЃЌ:

**рЃАрЃћрЃќрЃЮрЃюрЃБрЃарЃў рЃЎрЃЮрЃЏрЃърЃЮрЃюрЃћрЃюрЃбрЃў (Seasonal)**:
- рЃЏрЃЮрЃЊрЃћрЃџрЃА рЃћрЃЏрЃљрЃбрЃћрЃЉрЃљ (p,d,q,s) рЃърЃљрЃарЃљрЃЏрЃћрЃбрЃарЃћрЃЉрЃў рЃАрЃћрЃќрЃЮрЃюрЃБрЃарЃЮрЃЉрЃўрЃАрЃЌрЃЋрЃўрЃА
- s = 52 (рЃћрЃарЃЌрЃгрЃџрЃўрЃљрЃюрЃў рЃАрЃћрЃќрЃЮрЃюрЃБрЃарЃЮрЃЉрЃљ рЃЏрЃЮрЃюрЃљрЃфрЃћрЃЏрЃћрЃЉрЃерЃў)
- p,d,q рЃўрЃњрЃўрЃЋрЃћ рЃџрЃЮрЃњрЃўрЃЎрЃўрЃЌ рЃЏрЃБрЃерЃљрЃЮрЃЉрЃА

**рЃњрЃљрЃарЃћ рЃфрЃЋрЃџрЃљрЃЊрЃћрЃЉрЃў (eXogenous)**:
- рЃАрЃљрЃерЃБрЃљрЃџрЃћрЃЉрЃљрЃА рЃўрЃФрЃџрЃћрЃЋрЃљ рЃњрЃљрЃЏрЃЮрЃЋрЃўрЃДрЃћрЃюрЃЮрЃЌ рЃњрЃљрЃарЃћ рЃфрЃЋрЃџрЃљрЃЊрЃћрЃЉрЃў: CPI, unemployment, temperature, fuel_price
- рЃћрЃА рЃфрЃЋрЃџрЃљрЃЊрЃћрЃЉрЃў рЃЏрЃЮрЃЊрЃћрЃџрЃерЃў рЃерЃћрЃЊрЃўрЃА рЃарЃЮрЃњрЃЮрЃарЃф рЃЊрЃљрЃЏрЃљрЃбрЃћрЃЉрЃўрЃЌрЃў рЃўрЃюрЃцрЃЮрЃарЃЏрЃљрЃфрЃўрЃљ рЃЊрЃљ рЃгрЃЋрЃџрЃўрЃџрЃў рЃерЃћрЃљрЃЦрЃЋрЃА рЃњрЃљрЃЊрЃљрЃгрЃДрЃЋрЃћрЃбрЃЮрЃџрЃћрЃЉрЃўрЃА рЃЏрЃўрЃдрЃћрЃЉрЃљрЃерЃў

**рЃўрЃЏрЃърЃџрЃћрЃЏрЃћрЃюрЃбрЃљрЃфрЃўрЃўрЃА рЃЊрЃћрЃбрЃљрЃџрЃћрЃЉрЃў**:
- рЃњрЃљрЃЏрЃЮрЃДрЃћрЃюрЃћрЃЉрЃБрЃџрЃў рЃАрЃћрЃќрЃЮрЃюрЃБрЃарЃў рЃърЃљрЃарЃљрЃЏрЃћрЃбрЃарЃћрЃЉрЃў: (P=2, D=1, Q=3, s=52)
- рЃФрЃўрЃарЃўрЃЌрЃљрЃЊрЃў ARIMA рЃърЃљрЃарЃљрЃЏрЃћрЃбрЃарЃћрЃЉрЃў: (p=2, d=1, q=3)
- рЃњрЃљрЃарЃћ рЃфрЃЋрЃџрЃљрЃЊрЃћрЃЉрЃў: CPI, unemployment, temperature, fuel_price, holiday indicators

**рЃАрЃљрЃБрЃЎрЃћрЃЌрЃћрЃАрЃЮ рЃърЃљрЃарЃљрЃЏрЃћрЃбрЃарЃћрЃЉрЃў**: ARIMA(2,1,3) + Seasonal(1,2,1,52) + exog_variables
**Kaggle Score**: **3084.71 WMAE**

#### Prophet
**рЃЎрЃЮрЃюрЃфрЃћрЃцрЃфрЃўрЃљ**: Facebook Prophet рЃљрЃарЃўрЃА additive model-рЃў, рЃарЃЮрЃЏрЃћрЃџрЃўрЃф time series-рЃА рЃгрЃљрЃарЃЏрЃЮрЃЊрЃњрЃћрЃюрЃА рЃЮрЃЌрЃ«рЃў рЃЏрЃЌрЃљрЃЋрЃљрЃарЃў рЃЎрЃЮрЃЏрЃърЃЮрЃюрЃћрЃюрЃбрЃўрЃА рЃ»рЃљрЃЏрЃљрЃЊ:

**рЃЏрЃљрЃЌрЃћрЃЏрЃљрЃбрЃўрЃЎрЃБрЃарЃў рЃцрЃЮрЃарЃЏрЃБрЃџрЃљ**: y(t) = g(t) + s(t) + h(t) + ╬х(t)

**рЃЎрЃЮрЃЏрЃърЃЮрЃюрЃћрЃюрЃбрЃћрЃЉрЃўрЃА рЃЊрЃћрЃбрЃљрЃџрЃБрЃарЃў рЃљрЃдрЃгрЃћрЃарЃљ**:
- **g(t) - Trend**: рЃљрЃарЃљрЃгрЃарЃцрЃўрЃЋрЃў рЃбрЃарЃћрЃюрЃЊрЃў piecewise linear рЃцрЃБрЃюрЃЦрЃфрЃўрЃўрЃЌ
  - рЃљрЃЋрЃбрЃЮрЃЏрЃљрЃбрЃБрЃарЃљрЃЊ рЃърЃЮрЃБрЃџрЃЮрЃЉрЃА changepoints-рЃћрЃЉрЃА рЃЏрЃЮрЃюрЃљрЃфрЃћрЃЏрЃћрЃЉрЃерЃў
  - рЃўрЃДрЃћрЃюрЃћрЃЉрЃА Bayesian approach-рЃА trend flexibility-рЃўрЃАрЃЌрЃЋрЃўрЃА
- **s(t) - Seasonality**: рЃцрЃБрЃарЃўрЃћрЃА рЃАрЃћрЃарЃўрЃћрЃЉрЃўрЃА рЃАрЃљрЃцрЃБрЃФрЃЋрЃћрЃџрЃќрЃћ
  - рЃДрЃЮрЃЋрЃћрЃџрЃгрЃџрЃўрЃБрЃарЃў рЃЊрЃљ рЃЎрЃЋрЃўрЃарЃћрЃБрЃџрЃў рЃАрЃћрЃќрЃЮрЃюрЃБрЃарЃЮрЃЉрЃљ
  - s(t) = ╬Б(aРѓЎcos(2¤ђnt/P) + bРѓЎsin(2¤ђnt/P))
- **h(t) - Holidays**: рЃЊрЃдрЃћрЃАрЃљрЃАрЃгрЃљрЃБрЃџрЃћрЃЉрЃўрЃА effects
  - рЃЌрЃўрЃЌрЃЮрЃћрЃБрЃџрЃў holiday-рЃўрЃАрЃЌрЃЋрЃўрЃА рЃфрЃљрЃџрЃЎрЃћ parameter
  - windows around holidays (before/after effects)
- **╬х(t)**: error term

**рЃўрЃЏрЃърЃџрЃћрЃЏрЃћрЃюрЃбрЃљрЃфрЃўрЃўрЃА рЃцрЃћрЃўрЃЕрЃћрЃарЃћрЃЉрЃў**:
- рЃљрЃЋрЃбрЃЮрЃЏрЃљрЃбрЃБрЃарЃљрЃЊ рЃ«рЃџрЃљрЃЋрЃА missing values
- robust outliers-рЃўрЃАрЃљрЃЊрЃЏрЃў
- рЃљрЃЊрЃЋрЃўрЃџрЃў hyperparameter tuning
- uncertainty intervals рЃърЃарЃЮрЃњрЃюрЃЮрЃќрЃћрЃЉрЃўрЃАрЃЌрЃЋрЃўрЃА

**рЃАрЃљрЃБрЃЎрЃћрЃЌрЃћрЃАрЃЮ рЃърЃљрЃарЃљрЃЏрЃћрЃбрЃарЃћрЃЉрЃў**: 
```python
seasonality_mode = 'multiplicative'  # рЃљрЃю 'additive'
yearly_seasonality = True
weekly_seasonality = True
daily_seasonality = False
holidays = [thanksgiving, christmas, superbowl, labor_day]
```
**Kaggle Score**: **2831 WMAE**

---

###  **Tree-Based рЃЏрЃЮрЃЊрЃћрЃџрЃћрЃЉрЃў**

### Data Exploration and Preprocessing for Tree Models

**Tree-based рЃЏрЃЮрЃЊрЃћрЃџрЃћрЃЉрЃўрЃАрЃЌрЃЋрЃўрЃА Feature Engineering**:
Tree-based рЃЏрЃЮрЃЊрЃћрЃџрЃћрЃЉрЃў (XGBoost, LightGBM) рЃЋрЃћрЃа рЃљрЃдрЃўрЃЦрЃЋрЃљрЃЏрЃћрЃю рЃЊрЃарЃЮрЃА рЃърЃўрЃарЃЊрЃљрЃърЃўрЃа, рЃљрЃЏрЃўрЃбрЃЮрЃЏ рЃАрЃљрЃГрЃўрЃарЃЮрЃљ рЃЏрЃЮрЃюрЃљрЃфрЃћрЃЏрЃћрЃЉрЃўрЃА рЃњрЃљрЃарЃЊрЃљрЃЦрЃЏрЃюрЃљ tabular format-рЃерЃў lag features-рЃћрЃЉрЃўрЃА рЃЊрЃљ рЃАрЃћрЃќрЃЮрЃюрЃБрЃарЃў рЃўрЃюрЃЊрЃўрЃЎрЃљрЃбрЃЮрЃарЃћрЃЉрЃўрЃА рЃЊрЃљрЃЏрЃљрЃбрЃћрЃЉрЃўрЃЌ.

#### XGBoost (Extreme Gradient Boosting)
**рЃЎрЃЮрЃюрЃфрЃћрЃцрЃфрЃўрЃљ**: XGBoost рЃљрЃарЃўрЃА ensemble method рЃарЃЮрЃЏрЃћрЃџрЃўрЃф рЃўрЃДрЃћрЃюрЃћрЃЉрЃА gradient boosting рЃљрЃџрЃњрЃЮрЃарЃўрЃЌрЃЏрЃА:

**рЃљрЃџрЃњрЃЮрЃарЃўрЃЌрЃЏрЃўрЃА рЃЏрЃБрЃерЃљрЃЮрЃЉрЃўрЃА рЃърЃарЃўрЃюрЃфрЃўрЃърЃў**:
1. **Sequential Tree Building**: рЃ«рЃћрЃћрЃЉрЃў рЃерЃћрЃўрЃЦрЃЏрЃюрЃћрЃЉрЃљ рЃЌрЃљрЃюрЃЏрЃўрЃЏрЃЊрЃћрЃЋрЃарЃЮрЃЉрЃўрЃЌ
2. **Gradient Descent**: рЃДрЃЮрЃЋрЃћрЃџрЃў рЃљрЃ«рЃљрЃџрЃў рЃ«рЃћ рЃфрЃЊрЃўрЃџрЃЮрЃЉрЃА рЃгрЃўрЃюрЃљ рЃ«рЃћрЃћрЃЉрЃўрЃА рЃерЃћрЃфрЃЊрЃЮрЃЏрЃћрЃЉрЃўрЃА рЃерЃћрЃАрЃгрЃЮрЃарЃћрЃЉрЃљрЃА
3. **Regularization**: L1 рЃЊрЃљ L2 regularization overfitting-рЃўрЃА рЃЌрЃљрЃЋрЃўрЃЊрЃљрЃю рЃљрЃАрЃљрЃфрЃўрЃџрЃћрЃЉрЃџрЃљрЃЊ
4. **Feature Subsampling**: рЃДрЃЮрЃЋрЃћрЃџ iteration-рЃќрЃћ рЃЏрЃ«рЃЮрЃџрЃЮрЃЊ рЃюрЃљрЃгрЃўрЃџрЃЮрЃЉрЃарЃўрЃЋ features рЃњрЃљрЃЏрЃЮрЃўрЃДрЃћрЃюрЃћрЃЉрЃљ

**рЃЏрЃљрЃЌрЃћрЃЏрЃљрЃбрЃўрЃЎрЃБрЃарЃў рЃњрЃљрЃЏрЃЮрЃ«рЃљрЃбрЃБрЃџрЃћрЃЉрЃљ**:
```
┼ирхб = ╬Б(k=1 to K) fРѓќ(xрхб)
Obj = ╬Б(i=1 to n) l(yрхб, ┼ирхб) + ╬Б(k=1 to K) ╬Е(fРѓќ)
```
рЃАрЃљрЃЊрЃљрЃф l рЃљрЃарЃўрЃА loss function, ╬Е рЃљрЃарЃўрЃА regularization term

**Feature Engineering рЃЊрЃћрЃбрЃљрЃџрЃћрЃЉрЃў**:

**1. Lag Features**:
- **Simple Lags**: sales_lag_1, sales_lag_2, sales_lag_3, sales_lag_5, sales_lag_26, sales_lag_52
- **рЃарЃљрЃбрЃЮрЃЏ рЃћрЃА lag-рЃћрЃЉрЃў**: ACF/PACF рЃљрЃюрЃљрЃџрЃўрЃќрЃўрЃА рЃАрЃљрЃцрЃБрЃФрЃЋрЃћрЃџрЃќрЃћ рЃЏрЃюрЃўрЃерЃЋрЃюрЃћрЃџрЃЮрЃЋрЃљрЃюрЃў autocorrelations

**2. Rolling Window Features**:
- **Rolling Mean**: sales_rolling_mean_4, sales_rolling_mean_8, sales_rolling_mean_12
- **Rolling Std**: sales_rolling_std_4, sales_rolling_std_8
- **Rolling Max/Min**: sales_rolling_max_4, sales_rolling_min_4

**3. Exponentially Weighted Features**:
- **EWM**: sales_ewm_alpha_0.3, sales_ewm_alpha_0.7
- **рЃЏрЃўрЃќрЃљрЃюрЃў**: рЃБрЃцрЃарЃЮ рЃљрЃ«рЃљрЃџ рЃЏрЃЮрЃюрЃљрЃфрЃћрЃЏрЃћрЃЉрЃА рЃЏрЃћрЃбрЃў рЃгрЃЮрЃюрЃљ

**4. Date/Time Features**:
- **Linear**: year, month, week, day_of_year, week_of_year
- **Cyclical Encoding**: 
  - month_sin = sin(2¤ђ * month / 12)
  - month_cos = cos(2¤ђ * month / 12)
  - week_sin, week_cos

**5. Economic Features**:
- **Interpolated**: CPI_interpolated, unemployment_interpolated
- **Derived**: economic_pressure = CPI * unemployment
- **Markdown**: total_markdown, markdown_effectiveness

**6. Store/Dept Statistics**:
- **Historical**: store_mean_sales, dept_mean_sales, store_dept_mean_sales
- **Variability**: store_sales_std, dept_sales_std

*
**рЃ░рЃўрЃърЃћрЃарЃърЃљрЃарЃљрЃЏрЃћрЃбрЃарЃћрЃЉрЃўрЃА рЃЊрЃћрЃбрЃљрЃџрЃБрЃарЃў рЃљрЃдрЃгрЃћрЃарЃљ**:
- **learning_rate (0.01-0.3)**: gradient descent-рЃўрЃА step size
- **n_estimators (100-5000)**: рЃ«рЃћрЃћрЃЉрЃўрЃА рЃарЃљрЃЮрЃЊрЃћрЃюрЃЮрЃЉрЃљ
- **max_depth (3-15)**: рЃ«рЃўрЃА рЃЏрЃљрЃЦрЃАрЃўрЃЏрЃљрЃџрЃБрЃарЃў рЃАрЃўрЃдрЃарЃЏрЃћ
- **min_child_weight (1-10)**: leaf node-рЃўрЃА рЃЏрЃўрЃюрЃўрЃЏрЃљрЃџрЃБрЃарЃў рЃгрЃЮрЃюрЃљ
- **subsample (0.6-1.0)**: sample fraction рЃДрЃЮрЃЋрЃћрЃџ iteration-рЃќрЃћ
- **colsample_bytree (0.6-1.0)**: feature fraction рЃДрЃЮрЃЋрЃћрЃџ рЃ«рЃћрЃќрЃћ
- **gamma (0-5)**: minimum split loss
- **reg_alpha (0-10)**: L1 regularization
- **reg_lambda (0-10)**: L2 regularization


**Kaggle Score**: **4544 WMAE**

#### LightGBM (Light Gradient Boosting Machine)
**рЃЎрЃЮрЃюрЃфрЃћрЃцрЃфрЃўрЃљ**: LightGBM рЃљрЃарЃўрЃА Microsoft-рЃўрЃА рЃЏрЃўрЃћрЃа рЃерЃћрЃЦрЃЏрЃюрЃўрЃџрЃў gradient boosting framework, рЃарЃЮрЃЏрЃћрЃџрЃўрЃф рЃЮрЃърЃбрЃўрЃЏрЃўрЃќрЃћрЃЉрЃБрЃџрЃўрЃљ рЃАрЃўрЃЕрЃЦрЃљрЃарЃўрЃАрЃљ рЃЊрЃљ рЃЏрЃћрЃ«рЃАрЃўрЃћрЃарЃћрЃЉрЃўрЃА рЃћрЃцрЃћрЃЦрЃбрЃБрЃарЃЮрЃЉрЃўрЃАрЃЌрЃЋрЃўрЃА.

**Tree Growing Strategy**:
- **LightGBM**: Leaf-wise tree growth (рЃДрЃЋрЃћрЃџрЃљрЃќрЃћ рЃЊрЃўрЃЊрЃў loss reduction-рЃўрЃА рЃЏрЃЦрЃЮрЃюрЃћ рЃцрЃЮрЃЌрЃЮрЃџрЃў)

**рЃЏрЃћрЃ«рЃАрЃўрЃћрЃарЃћрЃЉрЃўрЃА рЃњрЃљрЃЏрЃЮрЃДрЃћрЃюрЃћрЃЉрЃљ**:
- **Feature Bundling**: sparse features-рЃћрЃЉрЃўрЃА рЃњрЃљрЃћрЃарЃЌрЃўрЃљрЃюрЃћрЃЉрЃљ
- **Histogram-based Algorithm**: рЃарЃўрЃфрЃ«рЃЋрЃћрЃЉрЃўрЃА binning рЃЏрЃћрЃ«рЃАрЃўрЃћрЃарЃћрЃЉрЃўрЃА рЃЊрЃљрЃАрЃљрЃќрЃЮрЃњрЃљрЃЊ

**Categorical Features**:
- рЃњрЃљрЃюрЃўрЃ«рЃўрЃџрЃљрЃЋрЃА categorical variables-рЃћрЃЉрЃА encoding-рЃўрЃА рЃњрЃљрЃарЃћрЃерЃћ
- рЃљрЃЋрЃбрЃЮрЃЏрЃљрЃбрЃБрЃарЃў optimal split-рЃћрЃЉрЃўрЃА рЃърЃЮрЃЋрЃюрЃљ

**рЃўрЃЏрЃърЃџрЃћрЃЏрЃћрЃюрЃбрЃљрЃфрЃўрЃўрЃА рЃЌрЃљрЃЋрЃўрЃАрЃћрЃЉрЃБрЃарЃћрЃЉрЃћрЃЉрЃў**:
- рЃўрЃњрЃўрЃЋрЃћ feature engineering рЃарЃЮрЃњрЃЮрЃарЃф XGBoost-рЃўрЃАрЃЌрЃЋрЃўрЃА
- рЃБрЃцрЃарЃЮ рЃЏрЃфрЃўрЃарЃћ hyperparameter space (рЃЕрЃЦрЃљрЃарЃўрЃљ training)
- categorical features-рЃћрЃЉрЃўрЃА encoding рЃњрЃљрЃарЃћрЃерЃћ рЃБрЃЎрЃћрЃЌрЃћрЃАрЃў рЃерЃћрЃЊрЃћрЃњрЃћрЃЉрЃў




#### DLinear (Decomposition Linear)
**рЃЎрЃЮрЃюрЃфрЃћрЃцрЃфрЃўрЃљ**: DLinear рЃљрЃарЃўрЃА рЃњрЃљрЃЏрЃЮрЃфрЃЊрЃўрЃџрЃљрЃЊ рЃЏрЃљрЃарЃбрЃўрЃЋрЃў рЃЏрЃЮрЃЊрЃћрЃџрЃў, рЃарЃЮрЃЏрЃћрЃџрЃўрЃф рЃљрЃЕрЃЋрЃћрЃюрЃћрЃЉрЃА рЃарЃЮрЃЏ рЃЎрЃЮрЃЏрЃърЃџрЃћрЃЦрЃАрЃБрЃарЃў neural networks рЃДрЃЮрЃЋрЃћрЃџрЃЌрЃЋрЃўрЃА рЃљрЃа рЃљрЃарЃўрЃА рЃАрЃљрЃГрЃўрЃарЃЮ time series forecasting-рЃўрЃАрЃЌрЃЋрЃўрЃА.

**рЃљрЃарЃЦрЃўрЃбрЃћрЃЦрЃбрЃБрЃарЃўрЃА рЃАрЃўрЃЏрЃљрЃарЃбрЃўрЃЋрЃћ**:
```
Input Time Series Рєњ Decomposition Рєњ Linear Layers Рєњ Output Forecast
```

**Decomposition рЃЏрЃћрЃЦрЃљрЃюрЃўрЃќрЃЏрЃў**:
1. **Seasonal Decomposition**:
   ```
   Seasonal = MovingAverage(Input, kernel_size)
   ```
2. **Trend Decomposition**:
   ```
   Trend = Input - Seasonal
   ```

**Linear Forecasting**:
```
Seasonal_Forecast = Linear_Seasonal(Seasonal_Component)
Trend_Forecast = Linear_Trend(Trend_Component)
Final_Forecast = Seasonal_Forecast + Trend_Forecast
```

**рЃЏрЃљрЃарЃбрЃўрЃЋрЃў рЃЏрЃљрЃњрЃарЃљрЃЏ рЃћрЃцрЃћрЃЦрЃбрЃБрЃарЃў**:
- рЃЏрЃ«рЃЮрЃџрЃЮрЃЊ 2 linear layer
- рЃљрЃа рЃАрЃљрЃГрЃўрЃарЃЮрЃћрЃЉрЃА рЃарЃЌрЃБрЃџ architecture-рЃА
- рЃФрЃљрЃџрЃўрЃљрЃю рЃАрЃгрЃарЃљрЃцрЃў training рЃЊрЃљ inference
- рЃЏрЃљрЃњрЃарЃљрЃЏ рЃ«рЃерЃўрЃарЃљрЃЊ рЃЎрЃЮрЃюрЃЎрЃБрЃарЃћрЃюрЃбрЃБрЃюрЃљрЃарЃўрЃљрЃюрЃўрЃљ complex models-рЃЌрЃљрЃю

**рЃ░рЃўрЃърЃћрЃарЃърЃљрЃарЃљрЃЏрЃћрЃбрЃарЃћрЃЉрЃўрЃА рЃЏрЃўрЃюрЃўрЃЏрЃљрЃџрЃЮрЃЉрЃљ**:
- **seq_len**: input sequence length
- **pred_len**: prediction horizon
- **kernel_size**: moving average window size decomposition-рЃўрЃАрЃЌрЃЋрЃўрЃА
- **individual**: рЃЌрЃўрЃЌрЃЮрЃћрЃБрЃџрЃў channel-рЃўрЃАрЃЌрЃЋрЃўрЃА рЃфрЃљрЃџрЃЎрЃћ parameters



**Kaggle Score**: **4617 WMAE**

#### N-BEATS (Neural Basis Expansion Analysis for Time Series)
**рЃЎрЃЮрЃюрЃфрЃћрЃцрЃфрЃўрЃљ**: N-BEATS рЃљрЃарЃўрЃА pure deep learning рЃЏрЃЮрЃЊрЃћрЃџрЃў time series forecasting-рЃўрЃАрЃЌрЃЋрЃўрЃА, рЃарЃЮрЃЏрЃћрЃџрЃўрЃф рЃљрЃа рЃАрЃљрЃГрЃўрЃарЃЮрЃћрЃЉрЃА domain knowledge-рЃА рЃљрЃю feature engineering-рЃА.

**рЃљрЃарЃЦрЃўрЃбрЃћрЃЦрЃбрЃБрЃарЃўрЃА рЃЊрЃћрЃбрЃљрЃџрЃБрЃарЃў рЃљрЃдрЃгрЃћрЃарЃљ**:

**1. Stack рЃЊрЃљ Block рЃАрЃбрЃарЃБрЃЦрЃбрЃБрЃарЃљ**:
```
N-BEATS = StackРѓЂ + StackРѓѓ + ... + StackРѓЎ
Stack = BlockРѓЂ + BlockРѓѓ + ... + BlockРѓў
```

**2. Block Types**:
- **Trend Block**: рЃърЃЮрЃџрЃўрЃюрЃЮрЃЏрЃўрЃБрЃарЃў рЃЉрЃљрЃќрЃўрЃА рЃцрЃБрЃюрЃЦрЃфрЃўрЃћрЃЉрЃў
  - Basis Functions: [1, t, t┬▓, t┬│, ..., tрхќ]
  - рЃърЃљрЃарЃљрЃЏрЃћрЃбрЃарЃў: polynomial_degree
- **Seasonality Block**: рЃцрЃБрЃарЃўрЃћрЃА рЃЉрЃљрЃќрЃўрЃА рЃцрЃБрЃюрЃЦрЃфрЃўрЃћрЃЉрЃў  
  - Basis Functions: [1, cos(2¤ђt), sin(2¤ђt), cos(4¤ђt), sin(4¤ђt), ...]
  - рЃърЃљрЃарЃљрЃЏрЃћрЃбрЃарЃў: num_harmonics
- **Generic Block**: рЃќрЃЮрЃњрЃљрЃЊрЃў рЃюрЃћрЃўрЃарЃЮрЃюрЃБрЃџрЃў рЃЦрЃАрЃћрЃџрЃў
  - рЃАрЃарЃБрЃџрЃў flexibility residuals-рЃўрЃАрЃЌрЃЋрЃўрЃА

**3. Forecasting рЃЏрЃћрЃЦрЃљрЃюрЃўрЃќрЃЏрЃў**:
рЃДрЃЮрЃЋрЃћрЃџрЃў Block-рЃўрЃАрЃЌрЃЋрЃўрЃА рЃ«рЃЊрЃћрЃЉрЃљ:
- **Backcast (bРѓќ)**: input-рЃўрЃА reconstruction
- **Forecast (fРѓќ)**: рЃЏрЃЮрЃЏрЃљрЃЋрЃџрЃўрЃА prediction

**рЃ░рЃўрЃърЃћрЃарЃърЃљрЃарЃљрЃЏрЃћрЃбрЃарЃћрЃЉрЃўрЃА рЃЊрЃћрЃбрЃљрЃџрЃБрЃарЃў рЃљрЃдрЃгрЃћрЃарЃљ**:
- **input_size (lookback)**: рЃарЃљрЃЏрЃЊрЃћрЃюрЃўрЃЌ рЃгрЃўрЃюрЃљ рЃЊрЃарЃЮрЃўрЃА рЃЏрЃЮрЃюрЃљрЃфрЃћрЃЏрЃА рЃњрЃљрЃЏрЃЮрЃўрЃДрЃћрЃюрЃћрЃЉрЃА
- **output_size (horizon)**: рЃарЃљрЃЏрЃЊрЃћрЃюрЃўрЃЌ рЃЏрЃЮрЃЏрЃљрЃЋрЃљрЃџрЃў рЃЊрЃарЃЮрЃўрЃА рЃЏрЃЮрЃюрЃљрЃфрЃћрЃЏрЃА рЃЊрЃљрЃљрЃърЃарЃЮрЃњрЃюрЃЮрЃќрЃўрЃарЃћрЃЉрЃА
- **stack_types**: ['trend', 'seasonality', 'generic'] рЃЎрЃЮрЃЏрЃЉрЃўрЃюрЃљрЃфрЃўрЃљ
- **nb_blocks_per_stack**: рЃЉрЃџрЃЮрЃЎрЃћрЃЉрЃўрЃА рЃарЃљрЃЮрЃЊрЃћрЃюрЃЮрЃЉрЃљ рЃЌрЃўрЃЌрЃЮрЃћрЃБрЃџ stack-рЃерЃў
- **thetas_dim**: internal representation dimension
- **share_weights_in_stack**: weights sharing рЃЏрЃћрЃЦрЃљрЃюрЃўрЃќрЃЏрЃў
- **hidden_layer_units**: FC layers-рЃўрЃА рЃќрЃЮрЃЏрЃљ

**рЃљрЃарЃЦрЃўрЃбрЃћрЃЦрЃбрЃБрЃарЃўрЃА рЃЌрЃљрЃЋрЃўрЃАрЃћрЃЉрЃБрЃарЃћрЃЉрЃћрЃЉрЃў**:
- рЃЌрЃўрЃЌрЃЮрЃћрЃБрЃџрЃў рЃЉрЃџрЃЮрЃЎрЃў рЃљрЃЎрЃћрЃЌрЃћрЃЉрЃА forecast-рЃА  рЃЊрЃљ backcast-рЃА
- рЃЉрЃџрЃЮрЃЎрЃћрЃЉрЃў рЃћрЃарЃЌрЃўрЃљрЃюрЃЊрЃћрЃЉрЃљ stack-рЃћрЃЉрЃерЃў рЃАрЃљрЃЉрЃЮрЃџрЃЮрЃЮ forecast-рЃўрЃАрЃЌрЃЋрЃўрЃА
- рЃљрЃа рЃАрЃљрЃГрЃўрЃарЃЮрЃћрЃЉрЃА feature engineering-рЃА

**Kaggle Score**: **3100.07**


#### PatchTST (Patching Time Series Transformer)
**рЃЎрЃЮрЃюрЃфрЃћрЃцрЃфрЃўрЃљ**: PatchTST рЃљрЃарЃўрЃА рЃљрЃ«рЃљрЃџрЃў transformer-based approach рЃарЃЮрЃЏрЃћрЃџрЃўрЃф рЃўрЃДрЃћрЃюрЃћрЃЉрЃА "patching" рЃбрЃћрЃЦрЃюрЃўрЃЎрЃљрЃА time series-рЃўрЃА рЃБрЃЎрЃћрЃЌрЃћрЃАрЃў modeling-рЃўрЃАрЃЌрЃЋрЃўрЃА.

**Patching рЃЏрЃћрЃЦрЃљрЃюрЃўрЃќрЃЏрЃў**:
```
Time Series: [xРѓЂ, xРѓѓ, xРѓЃ, ..., xРѓЂРѓђРѓђ]
рЃЏрЃљрЃњ: Patching (patch_size=10, stride=5)
Patches: [[xРѓЂ...xРѓЂРѓђ], [xРѓє...xРѓЂРѓЁ], [xРѓЂРѓЂ...xРѓѓРѓђ], ...]
```

**рЃљрЃарЃЦрЃўрЃбрЃћрЃЦрЃбрЃБрЃарЃўрЃА рЃюрЃљрЃЉрЃўрЃ»рЃћрЃЉрЃў**:

**1. Patching рЃЊрЃљ Linear Embedding**:
```
Input Time Series Рєњ Patch Creation Рєњ Linear Projection Рєњ Patch Embeddings
Positional Encoding Рєњ Final Input Embeddings
```

**2. Transformer Encoder**:
```
Multi-Head Self-Attention Рєњ Add & Norm Рєњ Feed Forward Рєњ Add & Norm
```

**3. Forecasting Head**:
```
Patch Embeddings Рєњ Linear Layers Рєњ Future Values
```

**Channel Independence**:
- рЃДрЃЮрЃЋрЃћрЃџрЃў time series (channel) рЃўрЃЏрЃБрЃерЃљрЃЋрЃћрЃЉрЃА рЃЊрЃљрЃЏрЃЮрЃБрЃЎрЃўрЃЊрЃћрЃЉрЃџрЃљрЃЊ
- рЃљрЃа рЃљрЃарЃўрЃА cross-channel information sharing
- рЃБрЃЎрЃћрЃЌрЃћрЃАрЃў рЃњрЃљрЃюрЃќрЃЮрЃњрЃљрЃЊрЃћрЃЉрЃљ
- рЃБрЃцрЃарЃЮ stable training рЃБрЃфрЃюрЃЮрЃЉ patterns-рЃќрЃћ

**рЃЏрЃЌрЃљрЃЋрЃљрЃарЃў рЃўрЃЊрЃћрЃљ - Patching**:
PatchTST approach:
- рЃЌрЃўрЃЌрЃЮрЃћрЃБрЃџрЃў patch = рЃћрЃарЃЌрЃў token
- рЃЏрЃЮрЃЎрЃџрЃћ sequence of patches Рєњ рЃЊрЃљрЃЉрЃљрЃџрЃў рЃЎрЃЮрЃЏрЃърЃџрЃћрЃЦрЃАрЃБрЃарЃЮрЃЉрЃљ
- рЃљрЃЊрЃњрЃўрЃџрЃЮрЃЉрЃарЃўрЃЋрЃў рЃърЃљрЃбрЃћрЃарЃюрЃћрЃЉрЃў patch-рЃћрЃЉрЃерЃў + рЃњрЃџрЃЮрЃЉрЃљрЃџрЃБрЃарЃў рЃърЃљрЃбрЃћрЃарЃюрЃћрЃЉрЃў patch-рЃА рЃерЃЮрЃарЃўрЃА


**рЃ░рЃўрЃърЃћрЃарЃърЃљрЃарЃљрЃЏрЃћрЃбрЃарЃћрЃЉрЃўрЃА рЃЏрЃюрЃўрЃерЃЋрЃюрЃћрЃџрЃЮрЃЉрЃљ**:
- **seq_len**: input sequence-рЃўрЃА рЃАрЃўрЃњрЃарЃФрЃћ
- **pred_len**: prediction horizon
- **patch_len**: рЃДрЃЮрЃЋрЃћрЃџрЃў patch-рЃўрЃА рЃАрЃўрЃњрЃарЃФрЃћ (рЃЏрЃюрЃўрЃерЃЋрЃюрЃћрЃџрЃЮрЃЋрЃљрЃюрЃў!)
- **stride**: patches-рЃА рЃерЃЮрЃарЃўрЃА рЃЊрЃљрЃерЃЮрЃарЃћрЃЉрЃљ
- **d_model**: embedding dimension
- **n_heads**: attention heads-рЃўрЃА рЃарЃљрЃЮрЃЊрЃћрЃюрЃЮрЃЉрЃљ
- **d_ff**: feed-forward dimension
- **n_layers**: transformer layers-рЃўрЃА рЃарЃљрЃЮрЃЊрЃћрЃюрЃЮрЃЉрЃљ
- **dropout**: regularization parameters

**Channel Independence рЃБрЃърЃўрЃарЃљрЃбрЃћрЃАрЃЮрЃЉрЃћрЃЉрЃў**:
- рЃЌрЃўрЃЌрЃЮрЃћрЃБрЃџрЃў time series рЃАрЃгрЃљрЃЋрЃџрЃЮрЃЉрЃА рЃАрЃљрЃЎрЃБрЃЌрЃљрЃа patterns
- рЃБрЃЎрЃћрЃЌрЃћрЃАрЃў scalability рЃЊрЃўрЃЊ dataset-рЃћрЃЉрЃќрЃћ
- рЃБрЃцрЃарЃЮ рЃЏрЃарЃљрЃЋрЃљрЃџрЃцрЃћрЃарЃЮрЃЋрЃљрЃюрЃў


### Model Pipeline рЃЊрЃљ Registry

**Pipeline рЃАрЃбрЃарЃБрЃЦрЃбрЃБрЃарЃљ**:
рЃДрЃЮрЃЋрЃћрЃџрЃў рЃАрЃљрЃБрЃЎрЃћрЃЌрЃћрЃАрЃЮ рЃЏрЃЮрЃЊрЃћрЃџрЃў рЃерЃћрЃюрЃљрЃ«рЃБрЃџрЃўрЃљ Pipeline рЃцрЃЮрЃарЃЏрЃљрЃбрЃерЃў:

pipeline = Pipeline([
    ('preprocessor', custom_preprocessor),
    ('feature_engineer', feature_transformer),
    ('model', best_model)
])

# Model Registry-рЃерЃў рЃарЃћрЃњрЃўрЃАрЃбрЃарЃљрЃфрЃўрЃљ
mlflow.sklearn.log_model(
    pipeline, 
    "model",
    registered_model_name=f"{model_name}_walmart_forecasting"
)
- рЃћрЃА рЃЏрЃ«рЃЮрЃџрЃЮрЃЊ sklearn рЃЏрЃЮрЃЊрЃћрЃџрЃћрЃЉрЃА

**Pipeline рЃЎрЃЮрЃЏрЃърЃЮрЃюрЃћрЃюрЃбрЃћрЃЉрЃў**:
- **Data Validation**: рЃЏрЃЮрЃюрЃљрЃфрЃћрЃЏрЃћрЃЉрЃўрЃА рЃ«рЃљрЃарЃўрЃАрЃ«рЃўрЃА рЃерЃћрЃЏрЃЮрЃгрЃЏрЃћрЃЉрЃљ
- **Preprocessing**: missing values handling, outlier detection
- **Feature Engineering**: lag features, rolling statistics, date features
- **Model**: trained forecasting model
- **Postprocessing**: predictions formatting, confidence intervals

---

## рЃЏрЃЮрЃЊрЃћрЃџрЃћрЃЉрЃўрЃА рЃерЃћрЃЊрЃљрЃарЃћрЃЉрЃљ рЃЊрЃљ рЃАрЃљрЃЉрЃЮрЃџрЃЮрЃЮ рЃерЃћрЃЊрЃћрЃњрЃћрЃЉрЃў


**рЃАрЃљрЃЉрЃЮрЃџрЃЮрЃЮ рЃерЃћрЃЊрЃћрЃњрЃћрЃЉрЃўрЃА рЃфрЃ«рЃарЃўрЃџрЃў:**


### Performance Analysis

**рЃбрЃЮрЃъ 3 рЃЏрЃЮрЃЊрЃћрЃџрЃў**:
1. ­ЪЦЄ **Prophet**
2. ­ЪЦѕ **SARIMA**
3. ­ЪЦЅ **N-BEATS**

**рЃЏрЃЮрЃЊрЃћрЃџрЃћрЃЉрЃўрЃА рЃЎрЃљрЃбрЃћрЃњрЃЮрЃарЃўрЃћрЃЉрЃўрЃА рЃЏрЃўрЃ«рЃћрЃЊрЃЋрЃўрЃЌ рЃљрЃюрЃљрЃџрЃўрЃќрЃў**:

**Statistical Models (ARIMA, SARIMAX, Prophet)**:
- **рЃБрЃърЃўрЃарЃљрЃбрЃћрЃАрЃЮрЃЉрЃћрЃЉрЃў**: рЃАрЃгрЃарЃљрЃцрЃў, рЃўрЃюрЃбрЃћрЃарЃърЃарЃћрЃбрЃўрЃарЃћрЃЉрЃљрЃЊрЃў, рЃЏрЃфрЃўрЃарЃћ рЃарЃћрЃАрЃБрЃарЃАрЃћрЃЉрЃў
- **рЃюрЃљрЃЎрЃџрЃЮрЃЋрЃљрЃюрЃћрЃЉрЃћрЃЉрЃў**: рЃџрЃўрЃЏрЃўрЃбрЃўрЃарЃћрЃЉрЃБрЃџрЃў feature capacity, рЃАрЃБрЃАрЃбрЃў multivariate handling

**Tree-Based Models (XGBoost, LightGBM)**:
- **рЃБрЃърЃўрЃарЃљрЃбрЃћрЃАрЃЮрЃЉрЃћрЃЉрЃў**: рЃЏрЃФрЃџрЃљрЃЋрЃарЃў feature engineering, рЃЎрЃљрЃарЃњрЃў performance/effort ratio
- **рЃюрЃљрЃЎрЃџрЃЮрЃЋрЃљрЃюрЃћрЃЉрЃћрЃЉрЃў**: manual feature engineering, рЃЊрЃарЃЮрЃўрЃЌрЃў рЃърЃљрЃбрЃћрЃарЃюрЃћрЃЉрЃў рЃ«рЃћрЃџрЃўрЃЌ рЃБрЃюрЃЊрЃљ рЃерЃћрЃЦрЃЏрЃюрЃљ

**Deep Learning Models (N-BEATS, TFT, PatchTST, DLinear)**:
- **рЃБрЃърЃўрЃарЃљрЃбрЃћрЃАрЃЮрЃЉрЃћрЃЉрЃў**: рЃљрЃЋрЃбрЃЮрЃЏрЃљрЃбрЃБрЃарЃў pattern recognition, long-term dependencies
- **рЃюрЃљрЃЎрЃџрЃЮрЃЋрЃљрЃюрЃћрЃЉрЃћрЃЉрЃў**: рЃЏрЃФрЃЏрЃћ рЃњрЃљрЃЏрЃЮрЃЌрЃЋрЃџрЃћрЃЉрЃў, hyperparameter рЃЏрЃњрЃарЃФрЃюрЃЮрЃЉрЃћрЃџрЃЮрЃЉрЃљ


### Time Series Forecasting-рЃўрЃА рЃАрЃърЃћрЃфрЃўрЃцрЃўрЃЎрЃБрЃарЃў рЃњрЃљрЃЎрЃЋрЃћрЃЌрЃўрЃџрЃћрЃЉрЃў

**1. Data Leakage-рЃўрЃА рЃЌрЃљрЃЋрЃўрЃЊрЃљрЃю рЃљрЃфрЃўрЃџрЃћрЃЉрЃљ**:
- Temporal validation splits-рЃўрЃА рЃЏрЃюрЃўрЃерЃЋрЃюрЃћрЃџрЃЮрЃЉрЃљ
- Feature engineering рЃЊрЃљ temporal consistency

**2. Model Selection Criteria**:
- рЃБрЃюрЃЊрЃљ рЃЋрЃўрЃърЃЮрЃЋрЃЮрЃЌ рЃЉрЃљрЃџрЃљрЃюрЃАрЃў рЃЎрЃЮрЃЏрЃърЃўрЃБрЃбрЃћрЃарЃБрЃџ рЃарЃћрЃАрЃБрЃарЃАрЃћрЃЉрЃА, рЃЊрЃарЃЮрЃАрЃљ рЃЊрЃљ рЃерЃћрЃЊрЃћрЃњрЃЉрЃА рЃерЃЮрЃарЃўрЃА

### рЃЏрЃЮрЃЏрЃљрЃЋрЃљрЃџрЃў рЃњрЃљрЃБрЃЏрЃ»рЃЮрЃЉрЃћрЃАрЃћрЃЉрЃћрЃЉрЃў

**Short-term Improvements**:
- рЃЋрЃћрЃфрЃЊрЃћрЃЉрЃЮрЃЊрЃўрЃЌ deep learning рЃЏрЃЮрЃЊрЃћрЃџрЃћрЃЉрЃўрЃА рЃБрЃЎрЃћрЃЌрЃћрЃАрЃў рЃърЃљрЃарЃљрЃЏрЃћрЃбрЃарЃћрЃЉрЃўрЃЌ рЃњрЃљрЃгрЃЋрЃарЃЌрЃюрЃљрЃА

**рЃбрЃћрЃЦрЃюрЃўрЃЎрЃБрЃарЃў рЃерЃћрЃќрЃдрЃБрЃЊрЃЋрЃћрЃЉрЃў рЃарЃљрЃф рЃњрЃЦрЃЮрЃюрЃЊрЃљрЃЌ**:
- рЃЋрЃЏрЃБрЃерЃљрЃЮрЃЉрЃЊрЃўрЃЌ рЃЕрЃЋрЃћрЃБрЃџрЃћрЃЉрЃарЃўрЃЋ Collab-рЃерЃў рЃЊрЃљ рЃерЃћрЃќрЃдрЃБрЃЊрЃБрЃџрЃў рЃўрЃДрЃЮ GPU usage
- рЃфрЃ«рЃћрЃџрЃљ

---